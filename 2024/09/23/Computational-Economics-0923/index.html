<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>Computational-Economics-0923 | Zerong</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="https://unpkg.com/normalize.css"><link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss/build/pure-min.css"><link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="https://unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="https://unpkg.com/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="https://unpkg.com/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="https://unpkg.com/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="https://unpkg.com/toastr/build/toastr.min.css"><div class="darkmode-toggle">🌓</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Computational-Economics-0923</h1><a id="logo" href="/.">Zerong</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Computational-Economics-0923</h1><div class="post-meta">2024-09-23<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 527</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 3</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="post-content"><p>numerical analysis 0923</p>
<p>写在前面：本周练习题组织得十分巧妙，最终实现的动态效果也十分直观明了。<br><strong>question 1:</strong> Plot $f(x)&#x3D;sin(x)+cos(x)$, for $x$ between $[-2,2]$ using symbolic expression</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%matlab code:</span></span><br><span class="line"><span class="comment">%declare the symbolic expression</span></span><br><span class="line">syms x;</span><br><span class="line"></span><br><span class="line"><span class="comment">%define the objective function f</span></span><br><span class="line">f=<span class="built_in">sin</span>(x)+<span class="built_in">cos</span>(x);</span><br><span class="line"></span><br><span class="line"><span class="comment">%set the initial series of x</span></span><br><span class="line">x_value=<span class="number">-2</span>:<span class="number">0.1</span>:<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">%get the function value of f</span></span><br><span class="line">f_value=double(subs(f,x,x_value));</span><br><span class="line"></span><br><span class="line"><span class="comment">%plot the figure of f</span></span><br><span class="line"><span class="built_in">plot</span>(x_value,f_value);</span><br></pre></td></tr></table></figure>



<p><strong>question 2:</strong> Conduct second-order approximation for $f(x)&#x3D;sin(x)+cos(x)$ at point $x&#x3D;0$, using symbolic expression</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%matlab code:</span></span><br><span class="line"><span class="comment">%to approximate the objective function, we must know its derivatives at certain points. we have set the symbolic x in E1, so just use it.</span></span><br><span class="line"><span class="comment">%first order devatives</span></span><br><span class="line">J=jacobian(f,x);</span><br><span class="line"></span><br><span class="line"><span class="comment">%second order devatives</span></span><br><span class="line">H=hessian(f,x);</span><br><span class="line"></span><br><span class="line"><span class="comment">%initial guess of x</span></span><br><span class="line">x_0=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">%get the equation of approximation</span></span><br><span class="line">SOA=subs(f,x,x_0)+subs(J,x,x_0)*(x-x_0)+<span class="number">0.5</span>*subs(H,x,x_0)*(x-x_0)^<span class="number">2</span>;</span><br></pre></td></tr></table></figure>



<p><strong>question 3:</strong> Plot $f(x)&#x3D;sin(x)+cos(x)$ and its second_order approximation in a single graph</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%we have got f_value in E1, and the format of SOA in E2, just calculate SOA and plot them.</span></span><br><span class="line"><span class="comment">%get the function value of SOA</span></span><br><span class="line">SOA_value=double(subs(SOA,x,x_value));</span><br><span class="line"></span><br><span class="line"><span class="comment">%plot them together</span></span><br><span class="line"><span class="built_in">figure</span></span><br><span class="line"><span class="built_in">plot</span>(x_value,f_value,<span class="string">&#x27;-b&#x27;</span>,x_value,SOA_value,<span class="string">&#x27;--r&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;f(x)&#x27;</span>);</span><br><span class="line">title(<span class="string">&#x27;E3&#x27;</span>);</span><br><span class="line">ylim([<span class="number">-3</span> <span class="number">3</span>])</span><br><span class="line">grid on</span><br></pre></td></tr></table></figure>



<p><strong>question 4:</strong> Apply Newton-Raphson method to find a local maximum for $f(x)&#x3D;sin(x)+cos(x)$</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%matlab code:</span></span><br><span class="line"><span class="comment">%define the series to store the sequence of updated maximizers</span></span><br><span class="line">xk=<span class="built_in">zeros</span>(<span class="number">100</span>,<span class="number">1</span>);</span><br><span class="line">xk(<span class="number">1</span>)=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">%set the for loop to update 100 maximizers</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">100</span> </span><br><span class="line"><span class="comment">%update xk using Newton-Raphson method </span></span><br><span class="line">x_next=xk(<span class="built_in">i</span>)-subs(H,x,xk(<span class="built_in">i</span>))^(<span class="number">-1</span>)*subs(J,x,xk(<span class="built_in">i</span>)); </span><br><span class="line">xk(<span class="built_in">i</span>+<span class="number">1</span>)=double(x_next);</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>



<p><strong>question 5:</strong> Plot the whole iteration process with initial guess $x&#x3D;0$, untill finding the local maximum for $f$.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%we now know how to get SOA at certain point in E2, and have already got the series of maximizers, at which we should conduct the SOA. so we just go through the xk(i) and draw the picture.</span></span><br><span class="line"><span class="comment">%generate an empty set</span></span><br><span class="line">frames=[];</span><br><span class="line"></span><br><span class="line"><span class="comment">%set the for loop</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> =<span class="number">1</span>:<span class="number">10</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">%get SOA at this point </span></span><br><span class="line">SOA=subs(f,x,xk(<span class="built_in">i</span>))+subs(J,x,xk(<span class="built_in">i</span>))*(x-xk(<span class="built_in">i</span>))+<span class="number">0.5</span>*subs(H,x,xk(<span class="built_in">i</span>))*(x-xk(<span class="built_in">i</span>))^<span class="number">2</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">%get the function value of SOA </span></span><br><span class="line">SOA_value=double(subs(SOA,x,x_value)); </span><br><span class="line"></span><br><span class="line"><span class="comment">%plot them together </span></span><br><span class="line"><span class="built_in">figure</span> </span><br><span class="line"><span class="built_in">plot</span>(x_value,f_value,<span class="string">&#x27;-b&#x27;</span>,x_value,SOA_value,<span class="string">&#x27;--r&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>); </span><br><span class="line">xlabel(<span class="string">&#x27;x&#x27;</span>); ylabel(<span class="string">&#x27;f(x)&#x27;</span>); title(<span class="string">&#x27;E3&#x27;</span>); ylim([<span class="number">-3</span> <span class="number">3</span>]) grid on </span><br><span class="line"></span><br><span class="line"><span class="comment">%save the picture </span></span><br><span class="line">frame=getframe(gcf); </span><br><span class="line">frames=[frames frame];</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%display all the saved plots</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">true</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> iter = <span class="number">1</span>:<span class="built_in">length</span>(frames) </span><br><span class="line">imshow(frames(<span class="built_in">i</span>).cdata); </span><br><span class="line">drawnow; </span><br><span class="line">pause(<span class="number">5</span>); </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</div><div class="tags"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/maths/" rel="tag">maths</a></li></ul></div><div class="post-nav"><a class="pre" href="/2024/09/23/%E4%BA%91%E9%B9%B0-%E4%BC%81%E4%B8%9A%E4%BB%B7%E6%A0%BC%E5%8A%A0%E6%88%90/">云鹰：企业价格加成</a><a class="next" href="/2024/09/23/Computational-Economics-0914/">Computational-Economics-0914</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://example.com"/></form></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="About"><img class="nofancybox" src="/img/avatar.jpg"/></a><p>To be a better man.</p><a class="info-icon" href="mailto:admin@domain.com" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/ZerongPu" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/math/" style="font-size: 15px;">math</a> <a href="/tags/maths/" style="font-size: 15px;">maths</a> <a href="/tags/economics/" style="font-size: 15px;">economics</a> <a href="/tags/daily-thoughts/" style="font-size: 15px;">daily thoughts</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2024/09/23/%E4%BA%91%E9%B9%B0-%E4%BC%81%E4%B8%9A%E4%BB%B7%E6%A0%BC%E5%8A%A0%E6%88%90/">云鹰：企业价格加成</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/09/23/Computational-Economics-0923/">Computational-Economics-0923</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/09/23/Computational-Economics-0914/">Computational-Economics-0914</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/09/23/Computational-Economics-0909/">Computational-Economics-0909</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/09/02/Computational-Economics-0902/">Computational-Economics-0902</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/09/02/Computational-Economics-0826/">Computational-Economics-0826</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/08/20/%E5%8A%A8%E6%80%81%E4%BC%98%E5%8C%96%EF%BC%9A%E5%8F%98%E5%88%86%E6%B3%95%E4%B8%AD%E7%9A%84%E6%AC%A7%E6%8B%89%E6%96%B9%E7%A8%8B/">动态优化：变分法中的欧拉方程</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/08/19/%E7%95%99%E7%BB%99%E4%BA%8C%E5%8D%81%E5%B2%81%E7%9A%84%E4%B8%89%E4%B8%AA%E6%95%85%E4%BA%8B/">留给二十岁的三个故事</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2025 <a href="/." rel="nofollow">Zerong.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="https://unpkg.com/@fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="https://unpkg.com/@fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>